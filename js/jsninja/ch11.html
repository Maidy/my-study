<div id="test">
	<b>Hello</b>, I'm a ninja!
</div>
<script>
(function(){
	var count = 1;
	this.rootedQuerySelectorAll = function(elem, query){
		var oldID = elem.id;
		elem.id = "rooted" + (count++);
		try {
			return elem.querySelectorAll( "#" + elem.id + " " + query );
       	} catch(e){
        	throw e;
       	} finally {
       		elem.id = oldID;
     	};
    }
})();
var b = rootedQuerySelectorAll(document.getElementById("test"), "div b");
assert(b.length === 0, "The selector is now rooted properly.");

var c = document.getElementById("test").querySelector("div b");
assert(c, "Only the last part of the selector matters.");

var x = document.getElementById("test").querySelectorAll("b:only-child");
console.log(x);

</script>


<script>
if (typeof document.evaluate === "function") {
	function getElementsByXPath(expression, parentElement) {
		var results = [];
		var query = document.evaluate(expression,
			parentElement || document,
			null,
			XPathResult.ORDERED_NODE_SNAPSHOT_TYPE, null);
		for (var i = 0, length = query.snapshotLength; i < length; i++)
			results.push(query.snapshotItem(i));
		return results;
	}
}
console.log(getElementsByXPath("//*[@id='test']", document.body));
</script>
